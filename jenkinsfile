node
{
    stage("1. git clone")
    {
       git credentialsId: 'Git-hub-Credentials', url: 'https://github.com/talk2anyi/hello-workflow.git'
    }
    
    stage("2. BuildDockerImage")
    {
        sh 'docker build -t talk2anyi/hello-workflow .'
    }
    stage('3. PushDockerImage')
    {
        withCredentials([string(credentialsId: 'Dockerhub-crendential', variable: 'Dockerhub-crendential')]) {
        sh 'docker login -u talk2anyi -p {Dockerhub-crendential}'
    }
        
        sh 'docker push talk2anyi/hello-workflow'
    }
    stage("4. RemoveDockerImages")
    {
        sh 'docker rmi ${docker images -q}'
    }
    stage("5. DeployAppToK8s")
    {
        sh 'kubect apply -f hello-workflow.yml'
    }
}
